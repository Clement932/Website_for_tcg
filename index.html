<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TCG Pocket Simulator - Ultimate</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Orbitron:wght@500;700;900&display=swap" rel="stylesheet">
</head>
<body>

    <div id="loader">
        <div class="loader-content">
            <div class="logo-text">TCG POCKET</div>
            <div class="loading-bar"><div class="loading-fill"></div></div>
        </div>
    </div>

    <nav class="main-nav">
        <div class="nav-left">
            <div class="nav-logo">TCG <span class="highlight">ULTIMATE</span></div>
        </div>
        
        <div class="nav-center">
            <button onclick="router('sets')" class="nav-btn active" id="btn-sets"><i class="fas fa-layer-group"></i> <span class="desktop-only">Extensions</span></button>
            <button onclick="router('collection')" class="nav-btn" id="btn-collection"><i class="fas fa-book"></i> <span class="desktop-only">Classeur</span></button>
            <button onclick="router('shop')" class="nav-btn" id="btn-shop"><i class="fas fa-store"></i> <span class="desktop-only">Boutique</span></button>
            <button onclick="openMissions()" class="nav-btn mission-btn-pulse"><i class="fas fa-trophy"></i> <span class="desktop-only">Missions</span></button>
        </div>

        <div class="nav-right">
            <div class="currency-badge">
                <i class="fas fa-hourglass-half currency-icon"></i>
                <span id="currency-display">0</span>
            </div>
        </div>
    </nav>

    <div class="dashboard-wrapper">
        <div class="dashboard-stats">
            <div class="profile-section">
                <div class="level-circle">
                    <span id="user-level">1</span>
                    <small>NIV</small>
                </div>
                <div class="xp-details">
                    <div class="xp-info"><span>XP</span> <small><span id="current-xp">0</span> / <span id="next-level-xp">100</span></small></div>
                    <div class="xp-track"><div id="xp-bar-fill" class="xp-fill"></div></div>
                </div>
            </div>
            
            <div class="stats-grid">
                <div class="stat-box">
                    <i class="fas fa-box-open"></i>
                    <div>
                        <span class="stat-val" id="booster-count">0</span>
                        <span class="stat-label">Ouverts</span>
                    </div>
                </div>
                <div class="stat-box">
                    <i class="fas fa-clone"></i>
                    <div>
                        <span class="stat-val"><span id="collection-count">0</span>/<span id="total-cards-count">0</span></span>
                        <span class="stat-label">Collection</span>
                    </div>
                </div>
            </div>
            
            <button onclick="resetData()" class="settings-btn"><i class="fas fa-cog"></i></button>
        </div>
    </div>

    <main id="app-container">
        <section id="view-sets" class="view-section active-view">
            <div id="sets-container" class="sets-grid"></div>
        </section>

        <section id="view-set-detail" class="view-section hidden">
            <div class="set-header-hero">
                <button class="nav-btn" onclick="router('sets')"><i class="fas fa-chevron-left"></i> Retour</button>
                <div class="set-title-box">
                    <h1 id="current-set-title">EXTENSION</h1>
                </div>
                <div class="search-box">
                    <i class="fas fa-search" style="color:var(--text-muted)"></i>
                    <input type="text" placeholder="Rechercher..." oninput="searchCards(this.value, 'cards-grid')">
                </div>
            </div>

            <div class="split-layout">
                <aside class="sidebar">
                    <div class="booster-cta-card">
                        <button class="btn-primary glow-effect" style="width:100%" onclick="initBoosterOpening()">
                            OUVRIR UN PACK
                        </button>
                    </div>
                    
                    <div class="filters-list">
                        <button onclick="filterView('all')" class="filter-chip active" data-filter="all">Tout</button>
                        <button onclick="filterView('owned')" class="filter-chip" data-filter="owned">Acquis</button>
                        <button onclick="filterView('missing')" class="filter-chip" data-filter="missing">Manquants</button>
                    </div>
                </aside>

                <div class="content-grid-area">
                    <div id="cards-grid" class="cards-grid"></div>
                </div>
            </div>
        </section>

        <section id="view-collection" class="view-section hidden">
            <div class="section-header">
                <h2>Mon Classeur</h2>
                <button class="btn-secondary" onclick="sellDuplicates()">
                    <i class="fas fa-recycle"></i> Vendre doublons
                </button>
            </div>
            <div id="global-grid" class="cards-grid"></div>
        </section>

        <section id="view-shop" class="view-section hidden">
            <div class="section-header">
                <h2>Marché aux cartes</h2>
                <p>Échangez vos sabliers contre des boosters.</p>
            </div>
            <div id="shop-grid" class="shop-grid"></div>
        </section>
    </main>

    <div id="modal-overlay" class="modal-overlay hidden">
        <div class="modal-card" style="background:var(--bg-panel); padding:20px; max-width:500px; margin:100px auto; border-radius:12px; border:1px solid #333;">
            <div class="modal-top" style="display:flex; justify-content:space-between; margin-bottom:20px;">
                <h3>Missions</h3>
                <button class="close-btn settings-btn" onclick="closeMissions()"><i class="fas fa-times"></i></button>
            </div>
            <p>Missions quotidiennes bientôt disponibles !</p>
        </div>
    </div>

    <div id="booster-scene" class="booster-scene hidden">
        <div id="pack-stage" class="stage-container">
            <div class="pack-3d-container" onclick="openPackAction()">
                <div class="pack-wrapper">
                    <div class="pack-face front">
                        <img id="pack-visual" src="" alt="Pack">
                    </div>
                </div>
            </div>
            <div style="margin-top:20px; font-weight:bold; letter-spacing:2px; animation:pulseGlow 2s infinite;">CLIQUEZ POUR OUVRIR</div>
        </div>

        <div id="cards-stage" class="stage-container hidden">
            <div id="opened-cards-area" class="cards-reveal-grid"></div>
        </div>

        <div id="scene-controls" class="scene-controls hidden" style="margin-top:30px; display:flex; gap:20px;">
            <button class="nav-btn" onclick="closeBoosterScene()">Terminer</button>
            <button class="btn-primary" onclick="replayBooster()">Encore !</button>
        </div>
    </div>

    <div id="toast-container"></div>

    <script src="cards_data.js"></script>
    <script src="script.js"></script>
</body>
</html>